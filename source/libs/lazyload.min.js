!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery||window.Zepto)}(function(e,t){var a,r,n=window,o=e(n),l={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:n,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:i,load:i,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:i,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"};function i(){}function c(e,t){return(t._$container==o?("innerHeight"in n?n.innerHeight:o.height())+o.scrollTop():t._$container.offset().top+t._$container.height())<=e.offset().top-t.threshold}function f(e,t){return(t._$container==o?o.scrollTop():t._$container.offset().top)>=e.offset().top+t.threshold+e.height()}function _(t,a){var r=0;t.each(function(l,i){var _,s,d,h,u=t.eq(l);if(!(u.width()<=0&&u.height()<=0||"none"===u.css("display")))if(a.vertical_only)if(f(u,a));else if(c(u,a)){if(++r>a.failure_limit)return!1}else p();else if(f(u,a)||(d=u,((h=a)._$container==o?e.fn.scrollLeft?o.scrollLeft():n.pageXOffset:h._$container.offset().left)>=d.offset().left+h.threshold+d.width()));else if(c(u,a)||(_=u,((s=a)._$container==o?o.width()+(e.fn.scrollLeft?o.scrollLeft():n.pageXOffset):s._$container.offset().left+s._$container.width())<=_.offset().left-s.threshold)){if(++r>a.failure_limit)return!1}else p();function p(){u.trigger("_lazyload_appear"),r=0}})}function s(e){return e.filter(function(t,a){return!e.eq(t)._lazyload_loadStarted})}r=Object.prototype.toString,a=function(e){return r.call(e).replace("[object ","").replace("]","")},e.fn.hasOwnProperty("lazyload")||(e.fn.lazyload=function(t){var r,c,f,d=this;return e.isPlainObject(t)||(t={}),e.each(l,function(r,i){var c=a(t[r]);-1!=e.inArray(r,["threshold","failure_limit","check_appear_throttle_time"])?"String"==c?t[r]=parseInt(t[r],10):"Number"!=c&&(t[r]=i):"container"==r?(t.hasOwnProperty(r)?t[r]==n||t[r]==document?t._$container=o:t._$container=e(t[r]):t._$container=o,delete t.container):!l.hasOwnProperty(r)||t.hasOwnProperty(r)&&c==a(l[r])||(t[r]=i)}),r="scroll"==t.event,f=0==t.check_appear_throttle_time?_:function(e,t){var a,r,n,o,l=0;return function(){a=this,r=arguments;var e=new Date-l;return o||(e>=t?i():o=setTimeout(i,t-e)),n};function i(){o=0,l=+new Date,n=e.apply(a,r),a=null,r=null}}(_,t.check_appear_throttle_time),c=r||"scrollstart"==t.event||"scrollstop"==t.event,d.each(function(a,r){var n=this,o=d.eq(a),l=o.attr("src"),f=o.attr("data-"+t.data_attribute),_=t.url_rewriter_fn==i?f:t.url_rewriter_fn.call(n,o,f),h=o.attr("data-"+t.data_srcset_attribute),u=o.is("img");if(1==o._lazyload_loadStarted||l==_)return o._lazyload_loadStarted=!0,void(d=s(d));o._lazyload_loadStarted=!1,u&&!l&&o.one("error",function(){o.attr("src",t.placeholder_real_img)}).attr("src",t.placeholder_data_img),o.one("_lazyload_appear",function(){var a,r=e.isArray(t.effect_params);function l(){a&&o.hide(),u?(h&&o.attr("srcset",h),_&&o.attr("src",_)):o.css("background-image",'url("'+_+'")'),a&&o[t.effect].apply(o,r?t.effect_params:[]),d=s(d)}o._lazyload_loadStarted||(a="show"!=t.effect&&e.fn[t.effect]&&(!t.effect_params||r&&0==t.effect_params.length),t.appear!=i&&t.appear.call(n,o,d.length,t),o._lazyload_loadStarted=!0,t.no_fake_img_loader||h?(t.load!=i&&o.one("load",function(){t.load.call(n,o,d.length,t)}),l()):e("<img />").one("load",function(){l(),t.load!=i&&t.load.call(n,o,d.length,t)}).attr("src",_))}),c||o.on(t.event,function(){o._lazyload_loadStarted||o.trigger("_lazyload_appear")})}),c&&t._$container.on(t.event,function(){f(d,t)}),o.on("resize load",function(){f(d,t)}),e(function(){f(d,t)}),this})});